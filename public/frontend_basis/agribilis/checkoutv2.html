<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Bootstrap-ecommerce by Vosidiy M.">

    <title>Website title - bootstrap html template</title>

    <!-- jQuery -->
    <script src="../js/jquery-2.0.0.min.js" type="text/javascript"></script>

    <!-- Bootstrap4 files-->
    <script src="../js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <link href="../css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Fonticons -->
    <link href="../fonts/fontawesome/css/all.min.css" type="text/css" rel="stylesheet">
    <link href="../fonts/feathericons/css/iconfont.css" rel="stylesheet" type="text/css" />
    <link href="../fonts/material-icons/css/materialdesignicons.css" rel="stylesheet" type="text/css" />

    <!-- custom style -->
    <link href="../css/ui.css" rel="stylesheet" type="text/css" />
    <link href="../css/responsive.css" rel="stylesheet" />

    <!-- custom javascript -->
    <script src="../js/script.js" type="text/javascript"></script>

</head>

<body>


    <style type="text/css">
        .section-content {
            min-height: 82vh;
        }
    </style>



    <header class="section-header">
        <nav class="navbar navbar-main navbar-expand-lg navbar-light">
            <div class="container">
                <a class="navbar-brand" href="#"><img src="../images/logo.png" class="logo"></a>

                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main_nav4"
                    aria-controls="main_nav4" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="main_nav4">
                    <form class="form-inline flex-grow-1 mr-auto my-2 my-lg-0">
                        <input class="form-control w-75 mr-sm-2" type="search" placeholder="What are you looking for?">
                        <button class="btn btn-primary my-2 my-sm-0" type="submit">Search</button>
                    </form>

                    <ul class="navbar-nav mt-2 mt-lg-0">
                        <li class="nav-item active mr-2">
                            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item mr-2">
                            <a class="nav-link" href="#">About</a>
                        </li>
                        <li class="nav-item mr-2">
                            <a class="nav-link" href="#">Shop</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">Contacts</a>
                        </li>
                        <li class="nav-item dropdown mr-2">
                            <a class="nav-link" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                                aria-haspopup="true" aria-expanded="false">
                                Profile <i class="fas fa-angle-down ml-1"></i>
                            </a>
                            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>



    <section class="section-content padding-y bg">
        <div class="container">

            <div class="row">
                <main class="col-md-8">

                    <article class="card mb-4">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-10">
                                    <h4 class="card-title text-success"><i class="fa fa-map-marker"
                                            aria-hidden="true"></i> Delivery Address</h4>
                                    <p>Patrick Demillo Buco <br />
                                        Phone (+63) 9773390832 <br />
                                        Email: jpbuco@cvsu.edu.ph <br />
                                        Location: Luksuhin Sulsugin Road, Marcos Highway St., Alfonso Cavite <br />
                                    </p>
                                </div>
                                <div class="col-md-2">
                                    <button class="btn btn-light">Change</button>
                                </div>
                            </div>
                        </div>
                    </article>


                    <article class="card mb-4">
                        <article class="card-body">
                            <header class="mb-4">
                                <h4 class="card-title text-success"><i class="fa fa-shopping-bag"
                                        aria-hidden="true"></i> Patrick Elementary School</h4>
                            </header>
                            <div class="row">
                                <div class="col-md-6">
                                    <figure class="itemside  mb-3">
                                        <div class="aside"><img src="../images/items/1.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>2x $290 = Total: <b>$430</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-6">
                                    <figure class="itemside  mb-3">
                                        <div class="aside"><img src="../images/items/2.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>2x $290 = Total: <b>$430</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-6">
                                    <figure class="itemside mb-3">
                                        <div class="aside"><img src="../images/items/3.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>1x $290 = Total: <b>$290</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-6">
                                    <figure class="itemside  mb-3">
                                        <div class="aside"><img src="../images/items/4.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>4x $290 = Total: <b>$430</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-12">
                                    <p><i class="fa fa-truck" aria-hidden="true"></i> Est. Arrival: 4-8 Dec. <br />
                                        16 items, Subtotal: <b>P1,500.00</b>
                                    </p>
                                </div>
                            </div>
                        </article>
                    </article>

                    <article class="card mb-4">
                        <article class="card-body">
                            <header class="mb-4">
                                <h4 class="card-title text-success"><i class="fa fa-shopping-bag"
                                        aria-hidden="true"></i> Bill Gates Lomihan</h4>
                            </header>
                            <div class="row">
                                <div class="col-md-6">
                                    <figure class="itemside  mb-3">
                                        <div class="aside"><img src="../images/items/1.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>2x $290 = Total: <b>$430</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-6">
                                    <figure class="itemside  mb-3">
                                        <div class="aside"><img src="../images/items/2.jpg" class="border img-xs"></div>
                                        <figcaption class="info">
                                            <p>Name of the product goes here or title </p>
                                            <span>2x $290 = Total: <b>$430</b> </span>
                                        </figcaption>
                                    </figure>
                                </div>
                                <div class="col-md-12">
                                    <p><i class="fa fa-truck" aria-hidden="true"></i> Est. Arrival: 9-12 Dec. <br />
                                        16 items, Subtotal: <b>P897.00</b>
                                    </p>
                                </div>
                            </div>
                        </article>
                    </article>

                    <article class="accordion mb-4" id="accordion_pay">
                        <div class="card">
                            <div class="collapse show">
                                <div class="card-body">
                                    <header class="mb-4">
                                        <h4 class="card-title text-success"> Select Payment Method</h4>
                                    </header>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <header class="card-header">
                                <img src="../images/misc/payment-bank.png" class="float-right" height="24">
                                <label class="form-check" data-toggle="collapse" data-target="#pay_card">
                                    <input class="form-check-input" name="payment-option" type="radio" value="option1"
                                        checked>
                                    <h6 class="form-check-label"> Cash on Delivery </h6>
                                </label>
                            </header>
                            <div id="pay_card" class="collapse" data-parent="#accordion_pay">
                                <div class="card-body">
                                    <p class="text-muted"> Pay when you receive </p>
                                </div>
                            </div>
                        </div>
                    </article>

                </main>

                <aside class="col-md-4">
                    <div class="card shadow">
                        <div class="card-body">
                            <h4 class="mb-3">Overview</h4>
                            <dl class="dlist-align">
                                <dt class="text-muted">Subtotal:</dt>
                                <dd>P7,435.00</dd>
                            </dl>
                            <dl class="dlist-align">
                                <dt class="text-muted">Shipping Total:</dt>
                                <dd>P99.00</dd>
                            </dl>
                            <dl class="dlist-align">
                                <dt class="text-muted">Payment method:</dt>
                                <dd>Cash on Delivery</dd>
                            </dl>
                            <hr>
                            <dl class="dlist-align">
                                <dt>Total:</dt>
                                <dd class="h5">$300.50</dd>
                            </dl>
                            <hr>
                            <a href="#foo" class="btn btn-success btn-block"> Place Order </a>
                        </div>
                    </div>
                </aside>
            </div>

        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        (async () => {

            const groupOrders = (orders) => {
                const keysArr = Object.keys(orders) //get the object's keys (orders ID)
                let groupedOrders = []

                //loop the orders ID
                keysArr.forEach(id => {
                    const commodity = orders[id]

                    //tailor the order's content
                    const revisedOrders = commodity.map(order => {
                        return {
                            id: order.id,
                            stringID: order.product_stringID,
                            name: order.product_name,
                            images: order.product_images,
                            quantity: order.quantity,
                            price: order.price,
                        }
                    })

                    //get the product vendor
                    const vendor = commodity[0].product_seller

                    //get the total quantity of all products
                    const items = commodity.reduce((sum, order) => {
                        return sum + order.quantity
                    }, 0)

                    //subtotal of all products
                    const subTotal = commodity.reduce((sum, order) => {
                        return sum + (order.price * order.quantity)
                    }, 0)

                    groupedOrders.push({
                        orderID: id,
                        vendor: vendor,
                        orders: revisedOrders,
                        items: items,
                        subTotal: subTotal,
                        deliveryTime: {
                            min: Math.min(...commodity.map(order => order.deliveryTime
                                .min)),
                            max: Math.max(...commodity.map(order => order.deliveryTime
                                .max))
                        },
                        created: commodity[0].created,
                        status: commodity[0].status

                    })
                });

                return groupedOrders
            }

            // end

            try {
                const response = await axios({
                    method: 'POST',
                    url: '../api/order/get.php',
                    data: {
                        id: 3163831460688019
                    }
                })

                // console.log(response)

                if (!response.data.status) throw (response.data)

                // const orders = response.data.orders
                // const groupedOrders = groupOrders(orders)
                // const totalAmount = groupedOrders.reduce((total, item) => total + item.subTotal, 0)

                // console.log(groupedOrders)
                // console.log(totalAmount)

            } catch (error) {
                alert('error please see console log')
                console.log(error)
            }
        })();
    </script>
</body>

</html>